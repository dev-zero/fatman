"""make test result <-> calculation an m:n relationship

Revision ID: 826f73cb69b5
Revises: ae7fd93d78b9
Create Date: 2016-12-19 15:37:36.153804

"""

# revision identifiers, used by Alembic.
revision = '826f73cb69b5'
down_revision = 'ae7fd93d78b9'

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        'test_result2_calculation',
        sa.Column('test_id', postgresql.UUID(as_uuid=True), nullable=False),
        sa.Column('calculation_id', postgresql.UUID(as_uuid=True), nullable=False),
        sa.ForeignKeyConstraint(['calculation_id'], ['calculation.id'], ),
        sa.ForeignKeyConstraint(['test_id'], ['test_result2.id'], ),
        sa.PrimaryKeyConstraint('test_id', 'calculation_id')
        )
    op.drop_constraint('test_result2_calculation_id_fkey', 'test_result2', type_='foreignkey')
    op.drop_column('test_result2', 'calculation_id')
    ### end Alembic commands ###


def downgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.add_column('test_result2', sa.Column('calculation_id', postgresql.UUID(), autoincrement=False, nullable=False))
    op.create_foreign_key('test_result2_calculation_id_fkey', 'test_result2', 'calculation', ['calculation_id'], ['id'])
    op.drop_table('test_result2_calculation')
    ### end Alembic commands ###
